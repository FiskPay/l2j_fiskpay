-- Create the table if it doesn't exist
CREATE TABLE IF NOT EXISTS `accounts` (
  `login` VARCHAR(45) NOT NULL DEFAULT '',
  PRIMARY KEY (`login`)
) DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

-- Add missing columns if they do not exist
ALTER TABLE `accounts`
  ADD COLUMN IF NOT EXISTS `password` VARCHAR(45),
  ADD COLUMN IF NOT EXISTS `email` VARCHAR(255) DEFAULT NULL,
  ADD COLUMN IF NOT EXISTS `created_time` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  ADD COLUMN IF NOT EXISTS `lastactive` BIGINT(13) UNSIGNED NOT NULL DEFAULT 0,
  ADD COLUMN IF NOT EXISTS `accessLevel` TINYINT NOT NULL DEFAULT 0,
  ADD COLUMN IF NOT EXISTS `lastIP` CHAR(15) NULL DEFAULT NULL,
  ADD COLUMN IF NOT EXISTS `lastServer` TINYINT DEFAULT 1,
  ADD COLUMN IF NOT EXISTS `pcIp` CHAR(15) DEFAULT NULL,
  ADD COLUMN IF NOT EXISTS `hop1` CHAR(15) DEFAULT NULL,
  ADD COLUMN IF NOT EXISTS `hop2` CHAR(15) DEFAULT NULL,
  ADD COLUMN IF NOT EXISTS `hop3` CHAR(15) DEFAULT NULL,
  ADD COLUMN IF NOT EXISTS `hop4` CHAR(15) DEFAULT NULL,
  ADD COLUMN IF NOT EXISTS `wallet_address` VARCHAR(42) NOT NULL DEFAULT 'not linked';

-- Ensure index exists on `wallet_address`
CREATE INDEX IF NOT EXISTS `wallet_address_index` ON `accounts` (`wallet_address`);